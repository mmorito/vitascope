# Vitascope デザインドキュメント

## 概要

このドキュメントは、Vitascope アプリケーションの詳細な設計と仕様を定義します。Vitascope は、ウェアラブルデバイスやヘルスケアデータをスマートフォン経由で収集し、可視化するためのプラットフォームです。

## システムアーキテクチャ

### 全体構成

Vitascope は以下の主要コンポーネントで構成されます：

```
┌─────────────────────────────────────┐
│          モバイルアプリケーション          │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ UI層    │ │ ビジネス層 │ │ データ層 │  │
│  └─────────┘ └─────────┘ └─────────┘  │
└───────────────────┬─────────────────┘
                    │
                    ▼
┌─────────────────────────────────────┐
│             APIゲートウェイ             │
└───────────────────┬─────────────────┘
                    │
                    ▼
┌─────────────────────────────────────┐
│            バックエンドサービス           │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ユーザー管理│ │データ分析 │ │通知サービス│  │
│  └─────────┘ └─────────┘ └─────────┘  │
└───────────────────┬─────────────────┘
                    │
                    ▼
┌─────────────────────────────────────┐
│              データストア              │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐  │
│  │ユーザーDB │ │健康データDB│ │分析結果DB│  │
│  └─────────┘ └─────────┘ └─────────┘  │
└─────────────────────────────────────┘
```

### テクノロジースタック

#### フロントエンド

- **フレームワーク**: React Native
- **状態管理**: Redux Toolkit
- **スタイリング**: NativeWind
- **開発環境**: Expo

#### バックエンド

- **言語**: Python 3.9+
- **API フレームワーク**: FastAPI
- **ORM**: SQLModel
- **認証**: Amazon Cognito
- **FHIR サポート**: HAPI FHIR (Java)／FHIR Works on AWS (サーバーレス)

#### インフラストラクチャ

- **クラウドプロバイダ**: AWS
- **データベース**: PostgreSQL（JSONB 対応）
- **キャッシュ**: Redis
- **ストレージ**: Amazon S3
- **CI/CD**: GitHub Actions

## 詳細ドキュメント

Vitascope の詳細設計は以下の専門ドキュメントに分割されています：

1. [データモデル設計](./data-model-design.md) - 内部データモデルとその実装方針
2. [FHIR データモデル設計](./fhir-data-model.md) - HL7 FHIR 準拠のデータモデル
3. [機能仕様](./functional-spec.md) - 詳細な機能要件とユースケース
4. [外部データソース連携](./external-data-sources.md) - HealthKit、Google Fit、Fitbit との連携
5. [UI/UX デザイン](./ui-ux-design.md) - ユーザーインターフェースと体験設計
6. [セキュリティ設計](./security-design.md) - データセキュリティと規制遵守
7. [開発・リリース計画](./development-plan.md) - フェーズ別の開発計画と実装ロードマップ

## API 設計

Vitascope では 2 種類の API エンドポイントを提供します：

### 内部 API（初期フェーズ）

RESTful な API エンドポイントを以下のように設計します：

```
GET /api/users/:id - ユーザー情報の取得
GET /api/users/:id/health-data - ユーザーの健康データ取得
GET /api/users/:id/devices - ユーザーのデバイス情報取得
GET /api/users/:id/insights - ユーザーの健康インサイト取得
```

### FHIR 準拠 API（中長期計画）

将来的な医療システムとの互換性のために、FHIR 準拠の API エンドポイントを実装します：

```
GET /fhir/Patient/:id - 患者情報の取得
GET /fhir/Observation?subject=Patient/:id - 患者の観測データ取得
GET /fhir/Device?owner=Patient/:id - 患者のデバイス情報取得
GET /fhir/DetectedIssue?patient=Patient/:id - 患者の健康インサイト取得
```

詳細な API 仕様については、[API 設計ドキュメント](./api-design.md)を参照してください。
